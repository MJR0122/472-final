<!DOCTYPE html><html><head>
  <meta charset="utf-8">
  <title>COVID-19</title>
  <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
  <script src="mapbox-gl.js"></script>
  <link href="https://api.mapbox.com/mapbox-gl-js/v1.9.0/mapbox-gl.css" rel="stylesheet">
  <style>
    body {
      margin: 0;
      padding: 0;
    }

    #map {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 100%;
    }
  </style>
</head>
<body>
  <style>
    #fly {
      display: block;
      position: relative;
      margin: 0px auto;
      width: 50%;
      height: 40px;
      padding: 10px;
      border: none;
      border-radius: 3px;
      font-size: 12px;
      text-align: center;
      color: #fff;
      background: #ee8a65;
    }
  </style>
  <div id="map"></div>
  <br>
  <button id="fly">Zoom to North America</button>
  <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoianJtYSIsImEiOiJjazhjMmZyZ3YwZmJvM2tvMTRxeDJjd3p0In0.YhRhoCJGysMrP5toMB6k6w';
    var map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/jrma/ck8ckimbq33fm1ipcpbonjdpv',
      center: [0, 90],
      zoom: 1.4,
      hash: true,
    });

//fly to
    document.getElementById('fly').addEventListener('click', function() {
      // Fly to a random location by offsetting the point -74.50, 40
      // by up to 5 degrees.
      map.flyTo({
        center: [
          -112.496068,
          50.908086
        ],
        zoom: 3,
        essential: true // this animation is considered essential with respect to prefers-reduced-motion
      });
    });
    
  //  -112.496068, 56.481347
    

//heatmap
    
    map.on('load', () => {
      map.addSource('confirmed', {
        'type': 'geojson',
        'data': 'https://raw.githubusercontent.com/MJR0122/472-final/master/overall.geojson'
      });

      map.addLayer({
          'id': 'coronavirus-heat',
          'type': 'heatmap',
          'source': 'confirmed',
          // 'maxzoom': 9,
          'paint': {
            // 热力权重，适用于集合图
            // Mapbox Expression https://docs.mapbox.com/mapbox-gl-js/style-spec/expressions/
            'heatmap-weight': [
              'interpolate',
              ['linear'],
              ['get', 'total_confirmed'],
              0, 0,
              20000, 10
            ],
            // 全局控制热力权重
            'heatmap-intensity': [
              'interpolate',
              ['linear'],
              ['zoom'],
              0, 2,
              10, 3
            ],
            // 热力图配色范围
            'heatmap-color': [
              'interpolate',
              ['linear'],
              ['heatmap-density'],
              0, "rgba(0, 0, 0, 0)",
              0.01, "#f6dd25",
              0.1, "#f7c120",
              0.15, "#f8a51b",
              0.2, "#f98a17",
              0.4, "#fa6e12",
              0.6, "#fb520d",
              0.8, "#fc3709",
              1, "red"
            ],

            // 每个热力点的绘制半径
            'heatmap-radius': [
              'interpolate',
              ['linear'],
              ['zoom'],
              0, 5,
              1, 10,
              2, 20,
              3, 40,
              4, 80,
              5, 160,
              6, 320,
              7, 640,
              8, 1280,
              9, 2560,
              10, 5120,
              11, 10240,
              17, 131072
            ],
            // 热力图的透明度
            'heatmap-opacity': [
              'interpolate',
              ['linear'],
              ['zoom'],
              5, 0.95,
              6, 0.5
            ]
          }
        },
        'waterway-label'
      );
    });


  </script>



</body></html>